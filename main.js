(()=>{"use strict";const e=[{Backquote:{en:{lower:"`",upper:"~"},ru:{lower:"ё",upper:"Ё"}},Digit1:{en:{lower:"1",upper:"!"},ru:{lower:"1",upper:"!"}},Digit2:{en:{lower:"2",upper:"@"},ru:{lower:"2",upper:'"'}},Digit3:{en:{lower:"3",upper:"#"},ru:{lower:"3",upper:"№"}},Digit4:{en:{lower:"4",upper:"$"},ru:{lower:"4",upper:";"}},Digit5:{en:{lower:"5",upper:"%"},ru:{lower:"5",upper:"%"}},Digit6:{en:{lower:"6",upper:"^"},ru:{lower:"6",upper:":"}},Digit7:{en:{lower:"7",upper:"&"},ru:{lower:"7",upper:"?"}},Digit8:{en:{lower:"8",upper:"*"},ru:{lower:"8",upper:"*"}},Digit9:{en:{lower:"9",upper:"("},ru:{lower:"9",upper:"("}},Digit0:{en:{lower:"0",upper:")"},ru:{lower:"0",upper:")"}},Minus:{en:{lower:"-",upper:"_"},ru:{lower:"-",upper:"_"}},Equal:{en:{lower:"=",upper:"+"},ru:{lower:"=",upper:"+"}},Backspace:{en:{lower:"Backspace",upper:"Backspace"},ru:{lower:"Backspace",upper:"Backspace"}}},{Tab:{en:{lower:"Tab",upper:"Tab"},ru:{lower:"Tab",upper:"Tab"}},KeyQ:{en:{lower:"q",upper:"Q"},ru:{lower:"й",upper:"Й"}},KeyW:{en:{lower:"w",upper:"W"},ru:{lower:"ц",upper:"Ц"}},KeyE:{en:{lower:"e",upper:"E"},ru:{lower:"у",upper:"У"}},KeyR:{en:{lower:"r",upper:"R"},ru:{lower:"к",upper:"К"}},KeyT:{en:{lower:"t",upper:"T"},ru:{lower:"е",upper:"Е"}},KeyY:{en:{lower:"y",upper:"Y"},ru:{lower:"н",upper:"Н"}},KeyU:{en:{lower:"u",upper:"U"},ru:{lower:"г",upper:"Г"}},KeyI:{en:{lower:"i",upper:"I"},ru:{lower:"ш",upper:"Ш"}},KeyO:{en:{lower:"o",upper:"O"},ru:{lower:"щ",upper:"Щ"}},KeyP:{en:{lower:"p",upper:"P"},ru:{lower:"з",upper:"З"}},BracketLeft:{en:{lower:"[",upper:"{"},ru:{lower:"х",upper:"Х"}},BracketRight:{en:{lower:"]",upper:"}"},ru:{lower:"ъ",upper:"Ъ"}},Backslash:{en:{lower:"\\",upper:"|"},ru:{lower:"\\",upper:"/"}},Delete:{en:{lower:"Del",upper:"Del"},ru:{lower:"Del",upper:"Del"}}},{CapsLock:{en:{lower:"Caps Lock",upper:"Caps Lock"},ru:{lower:"Caps Lock",upper:"Caps Lock"}},KeyA:{en:{lower:"a",upper:"A"},ru:{lower:"ф",upper:"Ф"}},KeyS:{en:{lower:"s",upper:"S"},ru:{lower:"ы",upper:"Ы"}},KeyD:{en:{lower:"d",upper:"D"},ru:{lower:"в",upper:"В"}},KeyF:{en:{lower:"f",upper:"F"},ru:{lower:"а",upper:"А"}},KeyG:{en:{lower:"g",upper:"G"},ru:{lower:"п",upper:"П"}},KeyH:{en:{lower:"h",upper:"H"},ru:{lower:"р",upper:"Р"}},KeyJ:{en:{lower:"j",upper:"J"},ru:{lower:"о",upper:"О"}},KeyK:{en:{lower:"k",upper:"K"},ru:{lower:"л",upper:"Л"}},KeyL:{en:{lower:"l",upper:"L"},ru:{lower:"д",upper:"Д"}},Semicolon:{en:{lower:";",upper:":"},ru:{lower:"ж",upper:"Ж"}},Quote:{en:{lower:"'",upper:'"'},ru:{lower:"э",upper:"Э"}},Enter:{en:{lower:"Enter",upper:"Enter"},ru:{lower:"Enter",upper:"Enter"}}},{ShiftLeft:{en:{lower:"Shift",upper:"Shift"},ru:{lower:"Shift",upper:"Shift"}},KeyZ:{en:{lower:"z",upper:"Z"},ru:{lower:"я",upper:"Я"}},KeyX:{en:{lower:"x",upper:"X"},ru:{lower:"ч",upper:"Ч"}},KeyC:{en:{lower:"c",upper:"C"},ru:{lower:"с",upper:"С"}},KeyV:{en:{lower:"v",upper:"V"},ru:{lower:"м",upper:"М"}},KeyB:{en:{lower:"b",upper:"B"},ru:{lower:"и",upper:"И"}},KeyN:{en:{lower:"n",upper:"N"},ru:{lower:"т",upper:"Т"}},KeyM:{en:{lower:"m",upper:"M"},ru:{lower:"ь",upper:"Ь"}},Comma:{en:{lower:",",upper:"<"},ru:{lower:"б",upper:"Б"}},Period:{en:{lower:".",upper:">"},ru:{lower:"ю",upper:"Ю"}},Slash:{en:{lower:"/",upper:"?"},ru:{lower:".",upper:","}},ArrowUp:{en:{lower:"▲",upper:"▲"},ru:{lower:"▲",upper:"▲"}},ShiftRight:{en:{lower:"Shift",upper:"Shift"},ru:{lower:"Shift",upper:"Shift"}}},{ControlLeft:{en:{lower:"Ctrl",upper:"Ctrl"},ru:{lower:"Ctrl",upper:"Ctrl"}},MetaLeft:{en:{lower:"Win",upper:"Win"},ru:{lower:"Win",upper:"Win"}},AltLeft:{en:{lower:"Alt",upper:"Alt"},ru:{lower:"Alt",upper:"Alt"}},Space:{en:{lower:" ",upper:" "},ru:{lower:" ",upper:" "}},AltRight:{en:{lower:"Alt",upper:"Alt"},ru:{lower:"Alt",upper:"Alt"}},ArrowLeft:{en:{lower:"◄",upper:"◄"},ru:{lower:"◄",upper:"◄"}},ArrowDown:{en:{lower:"▼",upper:"▼"},ru:{lower:"▼",upper:"▼"}},ArrowRight:{en:{lower:"►",upper:"►"},ru:{lower:"►",upper:"►"}},ControlRight:{en:{lower:"Ctrl",upper:"Ctrl"},ru:{lower:"Ctrl",upper:"Ctrl"}}}],r=document.createElement("main"),t=document.createElement("div"),p=document.createElement("h1"),o=document.createElement("textarea"),s=document.createElement("div"),l=document.createElement("div");t.classList.add("container"),o.classList.add("textarea"),s.classList.add("keyboard"),l.classList.add("info"),document.body.prepend(r),r.append(t),t.append(p,o,s,l),p.textContent="Виртуальная клавиатура",l.innerHTML="<p>Клавиатура создана в ОС Windows.</p><p>Комбинация для переключения языка: левыe shift + alt.</p>";const u=new class{constructor(e,r){this.keyboard=e,this.textarea=r,this.lang="en"===localStorage.getItem("lang")?"en":"ru",this.keyboardRows=[],this.isUpperRegister=!1,this.isDown=!1,this.isShiftDown=!1,this.isCaps=!1}renderKeyboard(){for(let r=0;r<e.length;r+=1){const t=document.createElement("div");t.classList.add("keyboard__row"),this.keyboard.append(t),this.keyboardRows.push([]);const p=Object.keys(e[r]);let o=0;p.forEach((s=>{const l=document.createElement("button");l.classList.add("keyboard__key"),l.dataset.code=p[o],l.innerHTML=e[r][s][this.lang].lower,t.append(l),this.keyboardRows[r].push(l),o+=1}))}}pasteSymbol(e,r){"Backspace"===r?this.textarea.selectionStart!==this.textarea.selectionEnd?this.textarea.setRangeText("",this.textarea.selectionStart,this.textarea.selectionEnd):0===this.textarea.selectionStart?this.textarea.setRangeText(""):this.textarea.setRangeText("",this.textarea.selectionStart-1,this.textarea.selectionEnd):"Delete"===r?this.textarea.selectionStart!==this.textarea.selectionEnd?this.textarea.setRangeText("",this.textarea.selectionStart,this.textarea.selectionEnd):this.textarea.setRangeText("",this.textarea.selectionStart,this.textarea.selectionEnd+1):(this.textarea.setRangeText(e),this.textarea.selectionStart+=e.length,this.textarea.selectionEnd=this.textarea.selectionStart)}switchRegister(r){let t;this.isUpperRegister?(t="lower",this.isUpperRegister=!1):(t="upper",this.isUpperRegister=!0),this.keyboardRows.forEach(((p,o)=>{p.forEach((p=>{const s=p;"en"===this.lang&&-1!==p.dataset.code.indexOf("Key")||"ru"===this.lang&&(-1!==p.dataset.code.indexOf("Key")||["Comma","Period","Semicolon","Quote","BracketLeft","BracketRight","Backquote"].includes(p.dataset.code))?s.innerHTML=e[o][p.dataset.code][this.lang][t]:"ShiftLeft"!==r&&"ShiftRight"!==r||(this.isShiftDown?s.innerHTML=e[o][p.dataset.code][this.lang].upper:s.innerHTML=e[o][p.dataset.code][this.lang].lower)}))}))}setHandlers(){document.addEventListener("keydown",(r=>{const t=document.querySelector(`[data-code="${r.code}"]`);if(t)if(t.classList.add("keyboard__key--pressed"),r.preventDefault(),"Backspace"===r.code)this.pasteSymbol("",r.code);else if("Tab"===r.code)this.pasteSymbol("    ");else if("Delete"===r.code)this.pasteSymbol("",r.code);else if("CapsLock"===r.code)this.switchRegister(r.code);else if("Enter"===r.code)this.pasteSymbol("\n");else if("ShiftLeft"===r.code||"ShiftRight"===r.code){if(this.isShiftDown)return;this.isShiftDown=!0,this.switchRegister(r.code)}else if(r.shiftKey&&r.altKey){let r;this.lang="en"===this.lang?"ru":"en",localStorage.setItem("lang",this.lang),r=this.isUpperRegister?"upper":"lower",this.keyboardRows.forEach(((t,p)=>{t.forEach((t=>{t.innerHTML=e[p][t.dataset.code][this.lang][r]}))}))}else"ControlLeft"!==r.code&&"ControlRight"!==r.code&&"AltRight"!==r.code&&"AltLeft"!==r.code&&"MetaLeft"!==r.code&&this.pasteSymbol(t.textContent)})),document.addEventListener("keyup",(e=>{const r=document.querySelector(`[data-code="${e.code}"]`);r&&("CapsLock"!==e.code?r.classList.remove("keyboard__key--pressed"):this.isCaps?(r.classList.remove("keyboard__key--pressed"),this.isCaps=!1):this.isCaps=!0,"ShiftLeft"!==e.code&&"ShiftRight"!==e.code||(this.isShiftDown=!1,this.switchRegister(e.code)))})),this.keyboard.addEventListener("mousedown",(e=>{const r=new KeyboardEvent("keydown",{code:e.target.dataset.code});document.dispatchEvent(r),this.isDown=!0})),this.keyboard.addEventListener("mouseup",(e=>{const r=new KeyboardEvent("keyup",{code:e.target.dataset.code});document.dispatchEvent(r),this.isDown=!1})),this.keyboard.addEventListener("mouseout",(e=>{if(this.isDown){const r=new KeyboardEvent("keyup",{code:e.target.dataset.code});document.dispatchEvent(r)}}))}}(s,o);u.renderKeyboard(),u.setHandlers(),o.focus(),o.addEventListener("blur",(()=>o.focus()))})();